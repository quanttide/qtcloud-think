# 开发计划：收集+澄清 MVP

## 产品愿景

当人类处于默认神经网络状态时，帮助人类承载需要切换到任务正向网络的任务，使人类可以专注于放松。

核心功能：收集人类思维流，澄清想法念头，记录清晰的知识结构。

---

## 核心流程

```
用户输入 → AI 判断模糊度 → [模糊] 多轮澄清 → [清晰] 存储为结构化 Markdown
```

---

## 需求确认

| 需求项 | 决策 |
|--------|------|
| 输入方式 | 文字输入 |
| 模糊判定 | AI 语义理解判断 |
| 追问方式 | 多轮对话（像朋友聊天帮你理清） |
| 存储格式 | 带 metadata 的 Markdown（frontmatter） |

---

## 输出格式规范

```markdown
---
created: 2024-01-15
status: clarified
summary: "一句话概括核心观点"
tags: []
original: "用户原始输入（保留）"
---
# [标题自动生成或用户确认]

[澄清后的清晰内容]
```

---

## 技术选型

| 模块 | 技术选型 | 理由 |
|------|----------|------|
| LLM | 通义千问（DashScope API） | 已有的 API 密钥 |
| CLI 框架 | Typer | Python 型安全 |
| 存储 | 本地文件系统（Markdown） | 兼容现有 Git 笔记体系 |
| 配置 | .env | 简单易用 |

---

## 项目结构

```
src/cli/
├── __init__.py
├── requirements.txt
├── llm_client.py    # LLM 调用封装
├── clarifier.py     # 模糊度判断 + 多轮澄清
├── storage.py       # Markdown 存储
└── main.py          # CLI 入口
```

---

## 实现阶段

### Phase 1：核心功能实现 ✅

#### 1.1 输入拦截器（Clarifier） ✅

- 用户输入任意文字
- 调用 LLM 判断是否"清晰完整"
- **判断标准**：
  - 有明确的主题/意图
  - 逻辑连贯
  - 有可执行的结论或足够的背景信息

#### 1.2 多轮澄清引擎 ✅

- 模糊时触发对话
- AI 主动追问（理解用户意图）
- 用户回复 → 重新评估 → 循环直到清晰

#### 1.3 结构化存储 ✅

- 输出格式：带 frontmatter 的 Markdown
- 文件命名：基于时间戳

---

### Phase 2：CLI 工具 ✅

- 快速验证核心逻辑
- 使用 Typer 构建命令行界面

---

### Phase 3：前端界面（可选）

- Web 界面或桌面端
- 提升交互体验

---

## 运行方式

```bash
cd src/cli
pip install -r requirements.txt
python main.py collect
```

---

## 验证指标

- **转化率**：多少输入最终被成功存储？
- **澄清轮数**：平均几轮对话能澄清一个想法？
- **召回测试**：存储后的笔记能否被语义搜索召回？
- **用户主观**：事后看澄清后的内容，是否比原始输入更清晰？

---

## 下一步

- [ ] 手动测试 CLI 完整流程
- [ ] 优化 prompt 效果
- [ ] 添加日志记录
- [ ] 错误处理增强
